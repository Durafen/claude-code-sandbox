{"id":"claude-code-sandbox-0p7","title":"Parse --worktree-branch and --cleanup flags","description":"Add command-line argument parsing for new flags. Parse --worktree-branch \u003cbranch\u003e and --cleanup flag in getopts section. Validate inputs and store in variables.","status":"closed","priority":2,"issue_type":"task","owner":"agent@gemini.cli","created_at":"2026-01-17T05:02:28.374463294Z","created_by":"Gemini Agent","updated_at":"2026-01-17T05:05:57.79551596Z","closed_at":"2026-01-17T05:05:57.79551596Z","close_reason":"Closed","labels":["core","orchestrated"]}
{"id":"claude-code-sandbox-0xb","title":"Update help documentation for worktree flags","description":"Add --worktree-branch and --cleanup to help output. Include examples showing usage in different modes (shell, claude, non-interactive). Explain auto-path generation and relative path support.","status":"closed","priority":2,"issue_type":"task","owner":"agent@gemini.cli","created_at":"2026-01-17T05:02:49.336788804Z","created_by":"Gemini Agent","updated_at":"2026-01-17T05:30:38.044212548Z","closed_at":"2026-01-17T05:30:38.044212548Z","close_reason":"Closed","labels":["doc","orchestrated"]}
{"id":"claude-code-sandbox-1kz","title":"Mount worktree directory in Docker container","description":"Add volume mount logic for worktree similar to BEADS_MOUNT pattern. Mount worktree to /workspace in container. Ensure paths with spaces are handled correctly using volume mount syntax.","status":"closed","priority":2,"issue_type":"task","owner":"agent@gemini.cli","created_at":"2026-01-17T05:02:38.845537466Z","created_by":"Gemini Agent","updated_at":"2026-01-17T05:23:58.536395586Z","closed_at":"2026-01-17T05:23:58.536395586Z","close_reason":"Closed","labels":["core","orchestrated"]}
{"id":"claude-code-sandbox-40l","title":"Test worktree feature across all execution modes","description":"Verify --worktree-branch works with: -s (shell mode), -c (claude mode), -n (non-interactive mode), --build, --docker flags. Test relative paths, branch creation fallback, cleanup functionality.","status":"closed","priority":2,"issue_type":"task","owner":"agent@gemini.cli","created_at":"2026-01-17T05:02:54.585523709Z","created_by":"Gemini Agent","updated_at":"2026-01-17T05:34:16.177588511Z","closed_at":"2026-01-17T05:34:16.177588511Z","close_reason":"Closed","labels":["orchestrated","test"]}
{"id":"claude-code-sandbox-4pl","title":"Auto-detect and forward dev server ports","description":"Add automatic port forwarding from container dev servers to host machine. Detect common dev ports (3000, 5000, 8000, 5173, etc.) and make them accessible from the host without user configuration.","status":"closed","priority":2,"issue_type":"epic","owner":"agent@gemini.cli","created_at":"2026-01-17T05:41:55.097947626Z","created_by":"Gemini Agent","updated_at":"2026-01-17T06:09:14.507624301Z","closed_at":"2026-01-17T06:09:14.507624301Z","close_reason":"Closed","labels":["feature","orchestrated"]}
{"id":"claude-code-sandbox-4pl.1","title":"Implement port detection utility","description":"Create a utility that detects which ports are listening inside the container. Should scan common dev server ports (3000, 3001, 5000, 5001, 5173, 5174, 8000, 8001, 8080, 9000, 9001) and return a list of listening ports. Can use netstat, ss, or /proc/net/tcp parsing.","status":"closed","priority":2,"issue_type":"task","owner":"agent@gemini.cli","created_at":"2026-01-17T05:42:17.351127011Z","created_by":"Gemini Agent","updated_at":"2026-01-17T06:08:53.759574833Z","closed_at":"2026-01-17T06:08:53.759574833Z","close_reason":"Closed","labels":["orchestrated"],"dependencies":[{"issue_id":"claude-code-sandbox-4pl.1","depends_on_id":"claude-code-sandbox-4pl","type":"parent-child","created_at":"2026-01-17T05:42:17.357974469Z","created_by":"Gemini Agent"},{"issue_id":"claude-code-sandbox-4pl.1","depends_on_id":"claude-code-sandbox-4pl.2","type":"blocks","created_at":"2026-01-17T05:43:49.027111054Z","created_by":"Gemini Agent"}]}
{"id":"claude-code-sandbox-4pl.2","title":"Modify docker run to forward detected ports","description":"Update the docker run commands in claude-code-sandbox wrapper to dynamically add -p flags for detected listening ports. Must work with shell mode, non-interactive mode, and Claude mode.","status":"closed","priority":2,"issue_type":"task","owner":"agent@gemini.cli","created_at":"2026-01-17T05:43:20.934215013Z","created_by":"Gemini Agent","updated_at":"2026-01-17T06:09:23.784572791Z","closed_at":"2026-01-17T06:09:23.784572791Z","close_reason":"Closed","labels":["orchestrated"],"dependencies":[{"issue_id":"claude-code-sandbox-4pl.2","depends_on_id":"claude-code-sandbox-4pl","type":"parent-child","created_at":"2026-01-17T05:43:20.942712846Z","created_by":"Gemini Agent"},{"issue_id":"claude-code-sandbox-4pl.2","depends_on_id":"claude-code-sandbox-4pl.3","type":"blocks","created_at":"2026-01-17T05:43:54.287320375Z","created_by":"Gemini Agent"},{"issue_id":"claude-code-sandbox-4pl.2","depends_on_id":"claude-code-sandbox-4pl.4","type":"blocks","created_at":"2026-01-17T05:43:59.539051419Z","created_by":"Gemini Agent"}]}
{"id":"claude-code-sandbox-4pl.3","title":"Document exposed dev server ports","description":"Add documentation to README.md explaining port forwarding, which ports are auto-forwarded, and examples.","status":"closed","priority":2,"issue_type":"task","owner":"agent@gemini.cli","created_at":"2026-01-17T05:43:26.204810209Z","created_by":"Gemini Agent","updated_at":"2026-01-17T06:09:04.132945671Z","closed_at":"2026-01-17T06:09:04.132945671Z","close_reason":"Closed","labels":["docs","orchestrated"],"dependencies":[{"issue_id":"claude-code-sandbox-4pl.3","depends_on_id":"claude-code-sandbox-4pl","type":"parent-child","created_at":"2026-01-17T05:43:26.214361876Z","created_by":"Gemini Agent"}]}
{"id":"claude-code-sandbox-4pl.4","title":"Integration tests for port forwarding","description":"Add integration tests to verify port detection, forwarding, and compatibility with existing modes.","status":"closed","priority":2,"issue_type":"task","owner":"agent@gemini.cli","created_at":"2026-01-17T05:43:31.487963837Z","created_by":"Gemini Agent","updated_at":"2026-01-17T06:09:09.32154434Z","closed_at":"2026-01-17T06:09:09.32154434Z","close_reason":"Closed","labels":["orchestrated","test"],"dependencies":[{"issue_id":"claude-code-sandbox-4pl.4","depends_on_id":"claude-code-sandbox-4pl","type":"parent-child","created_at":"2026-01-17T05:43:31.49813267Z","created_by":"Gemini Agent"}]}
{"id":"claude-code-sandbox-rtb","title":"Add Git Worktree Support to claude-code-sandbox","description":"Add --worktree-branch flag to enable isolated Claude Code execution in git worktrees. Includes auto-create from branch, path generation, optional cleanup, and integration with all existing modes.","status":"closed","priority":2,"issue_type":"epic","owner":"agent@gemini.cli","created_at":"2026-01-17T05:02:15.513056927Z","created_by":"Gemini Agent","updated_at":"2026-01-17T05:34:26.178112584Z","closed_at":"2026-01-17T05:34:26.178112584Z","close_reason":"Closed","labels":["epic","feature","orchestrated"]}
{"id":"claude-code-sandbox-wfd","title":"Implement worktree creation and path resolution","description":"Create function to generate worktree path from branch name (e.g., feat/test â†’ .worktrees/feat-test). Support relative paths like ../crm2. Auto-create worktree from branch if exists, else from HEAD. Handle errors gracefully.","status":"closed","priority":2,"issue_type":"task","owner":"agent@gemini.cli","created_at":"2026-01-17T05:02:33.577410171Z","created_by":"Gemini Agent","updated_at":"2026-01-17T05:20:39.561443716Z","closed_at":"2026-01-17T05:20:39.561443716Z","close_reason":"Closed","labels":["core","orchestrated"]}
{"id":"claude-code-sandbox-z1t","title":"Add worktree cleanup functionality","description":"Implement optional cleanup that removes the worktree after Claude Code finishes (only if --cleanup flag used). Should only clean if execution was successful. Clean up properly with git worktree remove or prune.","status":"closed","priority":2,"issue_type":"task","owner":"agent@gemini.cli","created_at":"2026-01-17T05:02:44.087726343Z","created_by":"Gemini Agent","updated_at":"2026-01-17T05:27:14.626778927Z","closed_at":"2026-01-17T05:27:14.626778927Z","close_reason":"Closed","labels":["core","orchestrated"]}
{"id":"claude-dc3","title":"Add native CLI build for agent-browser (faster startup)","description":"## Context\nagent-browser has an optional native CLI built with Rust that provides faster startup times. Currently we skip this because `npm install -g agent-browser` doesn't include the Rust source (`cli/Cargo.toml`).\n\n## Current Implementation (Dockerfile lines 89-95)\n```dockerfile\n# Install agent-browser with Playwright for browser automation\n# Install system deps for Playwright first (needs root)\nRUN npx playwright install-deps chromium\n\n# Install agent-browser and Playwright browser as node user\n# Note: build:native skipped - requires full git repo with Rust source\nRUN gosu 1000:1000 sh -c \"npm config set prefix ~/.npm-global \u0026\u0026 \\\n    npm install -g agent-browser \u0026\u0026 \\\n    npx playwright install chromium\"\n```\n\n## What's Needed for Native CLI\n1. Install Rust/Cargo toolchain (~300MB)\n2. Clone full repo from GitHub (has `cli/Cargo.toml`)\n3. Run `npm install` in repo\n4. Run `npm run build:native` (compiles Rust CLI)\n5. Install globally from built repo\n\n## Implementation Approach\n```dockerfile\n# Install Rust for node user\nRUN gosu 1000:1000 sh -c \"curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh -s -- -y\"\n\n# Clone and build agent-browser with native CLI\nRUN gosu 1000:1000 bash -c 'source ~/.cargo/env \u0026\u0026 \\\n    git clone https://github.com/anthropics/agent-browser.git /tmp/agent-browser \u0026\u0026 \\\n    cd /tmp/agent-browser \u0026\u0026 \\\n    npm install \u0026\u0026 \\\n    npm run build:native \u0026\u0026 \\\n    npm config set prefix ~/.npm-global \u0026\u0026 \\\n    npm install -g . \u0026\u0026 \\\n    rm -rf /tmp/agent-browser'\n```\n\n## Tradeoffs\n- **Pro**: Faster CLI startup time\n- **Con**: Adds ~500MB+ to image size (Rust toolchain + build artifacts)\n- **Con**: Longer build time\n- **Note**: Only affects startup latency, not actual browser automation speed\n\n## Decision Needed\nIs the faster startup worth the image bloat? Consider making this a build arg:\n```dockerfile\nARG AGENT_BROWSER_NATIVE=false\n```","status":"open","priority":3,"issue_type":"feature","owner":"duracula@gmail.com","created_at":"2026-01-20T01:04:16.688691+01:00","created_by":"Durafen","updated_at":"2026-01-20T01:04:16.688691+01:00"}
{"id":"claude-tio","title":"Secure credential storage in container (RAM-only options)","description":"## Problem\nCurrently, OAuth credentials are stored as a file on disk inside the container at `~/.claude/.credentials.json`. If the container is compromised, an attacker could access the token file.\n\nCurrent mitigations:\n- Token auto-rotates every ~8 hours\n- File permissions are 600\n\n## Options to Improve Security\n\n### Option 1: tmpfs mount (Recommended)\nStore credentials in RAM only, never touches disk.\n\n**Implementation:**\n1. Mount `.claude` directory as bind mount (for persistent configs like settings.json, CLAUDE.md)\n2. Mount tmpfs at `/run/secrets/claude/`\n3. Entrypoint script copies credentials to tmpfs and creates symlink:\n   ```bash\n   ln -sf /run/secrets/claude/.credentials.json ~/.claude/.credentials.json\n   ```\n\n**Pros:** Credentials only in RAM, auto-cleared on container stop\n**Cons:** More moving parts, fresh fetch every container start (no caching benefit)\n\n**Changes needed:**\n- ~10 lines in `claude-code-sandbox` script\n- ~5 lines in Dockerfile (entrypoint wrapper)\n- Exclude `.credentials.json` from bind mount sync\n\n### Option 2: Environment variable injection\nPass token via env var instead of file.\n\n**Implementation:**\n```bash\ndocker run -e ANTHROPIC_AUTH_TOKEN=\"$(security find-generic-password -s 'Claude Code-credentials' -w | jq -r '.claudeAiOauth.accessToken')\" ...\n```\n\n**Pros:** No file on disk at all\n**Cons:** Requires Claude Code to support env var auth (needs verification), env vars visible in `docker inspect`\n\n### Option 3: Docker secrets (Swarm only)\nUse Docker's built-in secrets management.\n\n**Implementation:**\n```bash\necho \"$CREDS\" | docker secret create claude_credentials -\ndocker service create --secret claude_credentials ...\n```\n\n**Pros:** Native Docker security feature\n**Cons:** Only works with Docker Swarm, not standalone containers\n\n### Option 4: Runtime stdin injection\nNever persist, pipe credentials at runtime.\n\n**Implementation:**\n```bash\nsecurity find-generic-password ... | docker run -i ... 'cat \u003e /tmp/creds \u0026\u0026 ln -s ...'\n```\n\n**Pros:** Minimal exposure window\n**Cons:** Complex, requires container cooperation\n\n## Recommendation\nOption 1 (tmpfs) offers the best balance of security and usability for standalone Docker usage. Consider implementing if running untrusted code in containers.\n\n## Current Status\nLow priority - current implementation with 8hr token rotation and file permissions is reasonable for trusted workloads.","status":"open","priority":3,"issue_type":"feature","owner":"duracula@gmail.com","created_at":"2026-01-20T01:03:34.751855+01:00","created_by":"Durafen","updated_at":"2026-01-20T01:03:34.751855+01:00"}
